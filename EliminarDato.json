{"files":[{"id":"e2b47b41-f4c1-4fd6-8dce-535f75598d39","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Guayaquil\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"b5fad1c0-09f0-4f4e-b40c-955b31b8d3b3","name":"Code","type":"server_js","source":"var SheetId \u003d \"1jANyD0255nc4Mrj1KzXb39pXqZjEtS5GNVtUk-NlEoI\";\n\nfunction doGet(e) {\n  return eliminarFila(e);\n}\n\nfunction doPost(e) {\n  return eliminarFila(e);\n}\n\nfunction eliminarFila(e) {\n  // Obtener una referencia a la hoja de Google Sheets\n  var sheetName \u003d \"Produccion\"; // Nombre de la hoja donde deseas exportar los datos\n  var spreadsheet \u003d SpreadsheetApp.openById(SheetId);\n  var sheet \u003d spreadsheet.getSheetByName(sheetName);\n  \n  // Obtener los parámetros de la solicitud HTTP\n  var parametros \u003d e.parameter;\n  \n  // Por ejemplo, supongamos que quieres agregar datos que vienen con los nombres \"nombre\" y \"edad\"\n  var fech \u003d String(parametros.fecha).split(\"-\");\n  var fecha \u003d fech[1]+\"-\"+fech[0]+\"-\"+fech[2];\n  var ordenio \u003d parametros.ordenio;\n  var puesto \u003d parametros.puesto;\n  var vaca \u003d parametros.vaca;\n  \n  // Obtener todos los datos de la hoja\n  var datos \u003d sheet.getDataRange().getDisplayValues();\n  \n  // Inicializar la variable para almacenar la fila encontrada\n  var filaAEliminar \u003d -1; // -1 indica que no se ha encontrado\n  \n  // Recorrer todas las filas de la hoja para encontrar el nombre\n  for (var i \u003d 0; i \u003c datos.length; i++) {\n    if (datos[i][0] \u003d\u003d fecha \u0026\u0026 datos[i][4] \u003d\u003d vaca \u0026\u0026 datos[i][3] \u003d\u003d puesto \u0026\u0026 datos[i][2] \u003d\u003d ordenio) { // Compara con el valor de la primera columna\n      filaAEliminar \u003d i + 1; // La matriz es cero-indexada, por lo que sumamos 1 para obtener el número de fila real\n      break; // Rompe el bucle una vez encontrado el valor\n    }\n  }\n\n  // Si se encontró la fila, eliminarla\n  if (filaAEliminar !\u003d -1) {\n    sheet.deleteRow(filaAEliminar);\n    return ContentService.createTextOutput(\"Fila eliminada correctamente.\");\n  } else {\n    return ContentService.createTextOutput(\"Nombre no encontrado en la hoja.\");\n  }\n}"}]}