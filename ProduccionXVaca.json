{"files":[{"id":"aacf2b96-df81-42c5-b382-b502ad4d30f6","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Guayaquil\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"c69224d3-5ed6-42b0-9f72-fc5594ef57ad","name":"Code","type":"server_js","source":"var SheetId \u003d \"1jANyD0255nc4Mrj1KzXb39pXqZjEtS5GNVtUk-NlEoI\";\n\n// Obtener la hoja de cálculo\nfunction getSheet() {\n  return SpreadsheetApp.openById(SheetId).getSheetByName(\"Produccion\");\n}\n\n// Función doGet para obtener datos\nfunction doGet(e) {\n  // Obtener la hoja\n  var sheet \u003d getSheet();\n  var select \u003d e.parameter;\n  \n  // Leer el contenido de la celda A1\n  var valorVol \u003d sheet.getRange(2, 6, sheet.getLastRow()-1, 1).getValues();\n  var valorID \u003d sheet.getRange(2, 5, sheet.getLastRow()-1, 1).getValues();\n  var suma \u003d 0;\n  \n  \n  if(select.opc\u003d\u003d\"todo\"){\n    for(i\u003d0;i\u003cvalorVol.length;i++){\n    suma \u003d suma + Number(valorVol[i]);\n    }\n  }else{\n    for(i\u003d0;i\u003cvalorID.length;i++){\n      if (valorID[i]\u003d\u003dselect.opc){\n        suma \u003d suma + Number(valorVol[i]);\n      }\n    }\n  }\n  // Devolver el valor como respuesta en formato JSON\n  return ContentService.createTextOutput(JSON.stringify( suma.toFixed(2) )) //\n                       .setMimeType(ContentService.MimeType.JSON);\n}\n\n// Función doPost para insertar datos\nfunction doPost(e) {\n  // Obtener los datos del cuerpo de la solicitud\n  var parametros \u003d JSON.parse(e.postData.contents);\n  var nuevoDato \u003d parametros.dato;\n  \n  // Obtener la hoja\n  var sheet \u003d getSheet();\n  \n  // Insertar el nuevo dato en la celda A1\n  sheet.getRange(\"D1\").setValue(nuevoDato);\n  \n  // Confirmar que los datos fueron guardados\n  return ContentService.createTextOutput(JSON.stringify({ resultado: \"Dato guardado correctamente\" }))\n                       .setMimeType(ContentService.MimeType.JSON);\n}"}]}