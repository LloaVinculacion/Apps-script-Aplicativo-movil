{"files":[{"id":"e172bacc-03cd-4b66-9588-c3a89f5ce6c9","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Guayaquil\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"b780e476-cedf-450d-8380-c8bd32a9eb40","name":"Code","type":"server_js","source":"//Firebase ID Library 1hguuh4Zx72XVC1Zldm_vTtcUUKUA6iBUOoGnJUWLfqDWx5WlOJHqYkrt\n\n// Define las variables globales\nvar FirebaseUrl \u003d \u0027https://enfermedades-a2df8-default-rtdb.firebaseio.com/\u0027;\nvar SheetId \u003d \u00271jANyD0255nc4Mrj1KzXb39pXqZjEtS5GNVtUk-NlEoI\u0027;\n\nfunction doGet() {\n  // Conectar a Firebase\n  var baseDatos \u003d FirebaseApp.getDatabaseByUrl(FirebaseUrl);\n  \n  // Obtener una referencia a la hoja de Google Sheets\n  var sheetName \u003d \u0027Enfermedades\u0027; // Nombre de la hoja donde deseas exportar los datos\n  var spreadsheet \u003d SpreadsheetApp.openById(SheetId);\n  var sheet \u003d spreadsheet.getSheetByName(sheetName);\n  \n  // Crear la hoja si no existe\n  if (sheet \u003d\u003d\u003d null) {\n    sheet \u003d spreadsheet.insertSheet(sheetName);\n  } else {\n    // Limpiar la hoja de cálculo si existe\n    sheet.clear();\n  }\n  \n  // Obtener los datos de Firebase\n  var data \u003d baseDatos.getData();\n  \n  // Escribir los datos en la hoja de cálculo en el orden especificado\n  var headerRow \u003d [\u0027IdAnimal\u0027, \u0027Enfermedad\u0027, \u0027Sintomas\u0027, \u0027Fecha\u0027, \u0027IdVet\u0027, \u0027NameVet\u0027, \u0027Observaciones\u0027];\n  sheet.appendRow(headerRow);\n  \n  for (var animal in data) {\n    for (var enfermedad in data[animal]) {\n      var rowData \u003d [\n        animal,\n        enfermedad,\n        data[animal][enfermedad].Sintomas.replace(/\"/g, \u0027\u0027), // Eliminar comillas dobles\n        data[animal][enfermedad].Fecha.replace(/\"/g, \u0027\u0027), // Eliminar comillas dobles\n        data[animal][enfermedad].IdVet.replace(/\"/g, \u0027\u0027), // Eliminar comillas dobles\n        data[animal][enfermedad].NameVet.replace(/\"/g, \u0027\u0027), // Eliminar comillas dobles\n        data[animal][enfermedad].Observaciones.replace(/\"/g, \u0027\u0027) // Eliminar comillas dobles\n      ];\n      \n      // Reemplazar celdas vacías con \"N/A\"\n      for (var i \u003d 0; i \u003c rowData.length; i++) {\n        if (rowData[i] \u003d\u003d\u003d \"\") {\n          rowData[i] \u003d \"N/A\";\n        }\n      }\n      \n      sheet.appendRow(rowData);\n    }\n  }\n  \n  // Alinear celdas a la izquierda\n  var numRows \u003d sheet.getLastRow();\n  var numCols \u003d sheet.getLastColumn();\n  if (numRows \u003e\u003d 2) {\n    var range \u003d sheet.getRange(2, 1, numRows - 1, numCols); // Excluir la fila de encabezado\n    range.setHorizontalAlignment(\"left\");\n  } else {\n    Logger.log(\u0027No existen datos en la base de datos.\u0027);\n  }\n\n  // Cambiar la primera fila por las cabeceras deseadas\n  var headerRowValues \u003d [\"ID ANIMAL\", \"ENFERMEDAD\", \"SINTOMAS\", \"FECHA\", \"ID VET\", \"NOMBRE VET\", \"OBSERVACIONES\"];\n  sheet.getRange(1, 1, 1, headerRowValues.length).setValues([headerRowValues]);\n\n  // Notificar que la exportación se ha completado\n  Logger.log(\u0027Exportación de datos completada.\u0027);\n}"}]}